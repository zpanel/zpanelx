var $data_a;function PMA_urldecode(a){return decodeURIComponent(a.replace(/\+/g,"%20"))}function PMA_urlencode(a){return encodeURIComponent(a).replace(/\%20/g,"+")}function getFieldName(c){var b=c.index();var a=!$("#table_results").find("th:first").hasClass("draggable");var f=a?$("#table_results").find("th:first").attr("colspan")-1:0;var e=$("#table_results").find("thead").find("th:eq("+(b-f)+") a").text();if(""==e){var d=$("#table_results").find("thead").find("th:eq("+(b-f)+")").children("span");var g=d.children().detach();e=d.text();d.append(g)}e=$.trim(e);return e}AJAX.registerTeardown("sql.js",function(){$("a.delete_row.ajax").unbind("click");$("#bookmarkQueryForm").die("submit");$("input#bkm_label").unbind("keyup");$("#sqlqueryresults").die("makegrid");$("#togglequerybox").unbind("click");$("#button_submit_query").die("click");$("input[name=bookmark_variable]").unbind("keypress");$("#sqlqueryform.ajax").die("submit");$("input[name=navig].ajax").die("click");$("#pageselector").die("change");$("#table_results.ajax").find("a[title=Sort]").die("click");$("#displayOptionsForm.ajax").die("submit");$("#resultsForm.ajax .mult_submit[value=edit]").die("click");$("#insertForm .insertRowTable.ajax input[type=submit]").die("click");$("#buttonYes.ajax").die("click");$("a.browse_foreign").die("click");$("th.column_heading.pointer").die("hover");$("th.column_heading.marker").die("click")});AJAX.registerOnload("sql.js",function(){$("a.delete_row.ajax").click(function(c){c.preventDefault();var b=$.sprintf(PMA_messages.strDoYouReally,$(this).closest("td").find("div").text());var a=$(this);a.PMA_confirm(b,a.attr("href"),function(d){$msgbox=PMA_ajaxShowMessage();$.get(d,{ajax_request:true,is_js_confirmed:true},function(e){if(e.success){PMA_ajaxShowMessage(e.message);a.closest("tr").remove()}else{PMA_ajaxShowMessage(e.error,false)}})})});$("#bookmarkQueryForm").live("submit",function(a){a.preventDefault();PMA_ajaxShowMessage();$.post($(this).attr("action"),"ajax_request=1&"+$(this).serialize(),function(b){if(b.success){PMA_ajaxShowMessage(b.message)}else{PMA_ajaxShowMessage(b.error,false)}})});$("input#bkm_label").keyup(function(){$("input#id_bkm_all_users, input#id_bkm_replace").parent().toggle($(this).val().length>0)}).trigger("keyup");$("#sqlqueryresults").live("makegrid",function(){PMA_makegrid($("#table_results")[0])});if(!$("#sqlqueryform").find("a").is("#togglequerybox")){$('<a id="togglequerybox"></a>').html(PMA_messages.strHideQueryBox).appendTo("#sqlqueryform").hide();$("#togglequerybox").bind("click",function(){var a=$(this);a.siblings().slideToggle("fast");if(a.text()==PMA_messages.strHideQueryBox){a.text(PMA_messages.strShowQueryBox);$("#togglequerybox_spacer").remove();a.before('<br id="togglequerybox_spacer" />')}else{a.text(PMA_messages.strHideQueryBox)}return false})}$("#button_submit_query").live("click",function(b){var a=$(this).closest("form");a.find("select[name=id_bookmark]").val("")});$("input[name=bookmark_variable]").bind("keypress",function(b){var a=(b.keyCode?b.keyCode:(b.which?b.which:b.charCode));if(a==13){$("#button_submit_bookmark").click();return false}else{return true}});$("#sqlqueryform.ajax").live("submit",function(c){c.preventDefault();var b=$(this);if(!checkSqlQuery(b[0])){return false}$("div.error").remove();var d=PMA_ajaxShowMessage();var a=$("#sqlqueryresults");PMA_prepareForAjaxRequest(b);$.post(b.attr("action"),b.serialize(),function(e){if(e.success==true){$("div.success, div.sqlquery_message").fadeOut();if($("#result_query").length){$("#result_query").remove()}if(typeof e.action_bookmark!="undefined"){if("1"==e.action_bookmark){$("#sqlquery").text(e.sql_query);setQuery(e.sql_query)}if("2"==e.action_bookmark){$("#id_bookmark option[value='"+e.id_bookmark+"']").remove()}a.show().html(e.message)}else{if(typeof e.sql_query!="undefined"){$('<div class="sqlquery_message"></div>').html(e.sql_query).insertBefore("#sqlqueryform");$("div.notice").remove()}else{a.show().html(e.message)}}if(typeof e.ajax_reload!="undefined"){if(e.ajax_reload.reload){if(e.ajax_reload.table_name){PMA_commonParams.set("table",e.ajax_reload.table_name);PMA_commonActions.refreshMain()}else{PMA_reloadNavigation()}}}else{if(typeof e.reload!="undefined"){PMA_commonActions.setDb(e.db);PMA_commonActions.refreshMain(false,function(){if($("#result_query").length){$("#result_query").remove()}if(e.sql_query){$('<div id="result_query"></div>').html(e.sql_query).prependTo("#page_content")}});PMA_reloadNavigation()}}a.show().trigger("makegrid");$("#togglequerybox").show();PMA_init_slider();if(typeof e.action_bookmark=="undefined"){if($('#sqlqueryform input[name="retain_query_box"]').is(":checked")!=true){if($("#togglequerybox").siblings(":visible").length>0){$("#togglequerybox").trigger("click")}}}}else{if(e.success==false){$("#sqlqueryform").before(e.error);a.hide()}}PMA_ajaxRemoveMessage(d)})});$("#pageselector").live("change",function(b){var a=$(this).parent("form");a.submit()});$("#displayOptionsForm.ajax").live("submit",function(a){a.preventDefault();$form=$(this);$.post($form.attr("action"),$form.serialize()+"&ajax_request=true",function(b){$("#sqlqueryresults").html(b.message).trigger("makegrid");PMA_init_slider()})});$("#resultsForm.ajax .mult_submit[value=edit]").live("click",function(d){d.preventDefault();if($("#table_results tbody tr, #table_results tbody tr td").hasClass("marked")){var a=$('<div id="change_row_dialog"></div>');var c={};c[PMA_messages.strCancel]=function(){$(this).dialog("close")};var e={};e[PMA_messages.strOK]=function(){$(this).dialog("close")};var b=$("#resultsForm");var f=PMA_ajaxShowMessage();$.get(b.attr("action"),b.serialize()+"&ajax_request=true&submit_mult=row_edit",function(g){if(g.success!=undefined&&g.success==false){a.append(g.error).dialog({title:PMA_messages.strChangeTbl,height:230,width:900,open:PMA_verifyColumnsProperties,close:function(h,i){$(this).remove()},buttons:e})}else{a.append(g.message).dialog({title:PMA_messages.strChangeTbl,height:600,width:900,open:PMA_verifyColumnsProperties,close:function(h,i){$(this).remove()},buttons:c}).find("#topmenucontainer").hide();$("table.insertRowTable").addClass("ajax");$("#buttonYes").addClass("ajax")}PMA_ajaxRemoveMessage(f)})}else{PMA_ajaxShowMessage(PMA_messages.strNoRowSelected)}});$("#insertForm .insertRowTable.ajax input[type=submit]").live("click",function(b){b.preventDefault();var a=$("#insertForm");PMA_prepareForAjaxRequest(a);$.post(a.attr("action"),a.serialize(),function(c){if(c.success==true){PMA_ajaxShowMessage(c.message);if($("#pageselector").length!=0){$("#pageselector").trigger("change")}else{$("input[name=navig].ajax").trigger("click")}}else{PMA_ajaxShowMessage(c.error,false);$("#table_results tbody tr.marked .multi_checkbox , #table_results tbody tr td.marked .multi_checkbox").prop("checked",false);$("#table_results tbody tr.marked .multi_checkbox , #table_results tbody tr td.marked .multi_checkbox").removeClass("last_clicked");$("#table_results tbody tr, #table_results tbody tr td").removeClass("marked")}if($("#change_row_dialog").length>0){$("#change_row_dialog").dialog("close").remove()}$("#result_query").remove();$("#sqlqueryresults").prepend(c.sql_query);$("#result_query .notice").remove();$("#result_query").prepend((c.message))})});$("#buttonYes.ajax").live("click",function(c){c.preventDefault();var a=$("#insertForm");var b=$("#insertForm").find("#actions_panel .control_at_footer option:selected").val();$("#result_query").remove();PMA_prepareForAjaxRequest(a);$.post(a.attr("action"),a.serialize(),function(d){if(d.success==true){PMA_ajaxShowMessage(d.message);if(b=="showinsert"){$("#sqlqueryresults").prepend(d.sql_query);$("#result_query .notice").remove();$("#result_query").prepend(d.message);$("#table_results tbody tr.marked .multi_checkbox , #table_results tbody tr td.marked .multi_checkbox").prop("checked",false);$("#table_results tbody tr.marked .multi_checkbox , #table_results tbody tr td.marked .multi_checkbox").removeClass("last_clicked");$("#table_results tbody tr, #table_results tbody tr td").removeClass("marked")}else{if($("#pageselector").length!=0){$("#pageselector").trigger("change")}else{$("input[name=navig].ajax").trigger("click")}$("#result_query").remove();$("#sqlqueryresults").prepend(d.sql_query);$("#result_query .notice").remove();$("#result_query").prepend((d.message))}}else{PMA_ajaxShowMessage(d.error,false);$("#table_results tbody tr.marked .multi_checkbox , #table_results tbody tr td.marked .multi_checkbox").prop("checked",false);$("#table_results tbody tr.marked .multi_checkbox , #table_results tbody tr td.marked .multi_checkbox").removeClass("last_clicked");$("#table_results tbody tr, #table_results tbody tr td").removeClass("marked")}if($("#change_row_dialog").length>0){$("#change_row_dialog").dialog("close").remove()}})})});function PMA_changeClassForColumn(b,a,d){var e=b.index();var c=!b.closest("tr").children(":first").hasClass("column_heading");if(c){e--}var f=b.closest("table").find("tbody tr").find("td.data:eq("+e+")");if(d==undefined){f.toggleClass(a)}else{f.toggleClass(a,d)}}AJAX.registerOnload("sql.js",function(){$("a.browse_foreign").live("click",function(a){a.preventDefault();window.open(this.href,"foreigners","width=640,height=240,scrollbars=yes,resizable=yes");$anchor=$(this);$anchor.addClass("browse_foreign_clicked")});$("th.column_heading.pointer").live("hover",function(a){PMA_changeClassForColumn($(this),"hover",a.type=="mouseenter")});$("th.column_heading.marker").live("click",function(){PMA_changeClassForColumn($(this),"marked")});$("#sqlqueryresults").trigger("makegrid")});function makeProfilingChart(){if($("#profilingchart").length==0||$("#profilingchart").html().length!=0){return}var a=[];$.each(jQuery.parseJSON($("#profilingChartData").html()),function(b,c){a.push([b,parseFloat(c)])});$("#profilingchart").html("").show();$("#profilingChartData").html("");PMA_createProfilingChartJqplot("profilingchart",a)};