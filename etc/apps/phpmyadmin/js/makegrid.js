function PMA_makegrid(b,f,d,e,a){var c={minColWidth:15,actionSpan:5,tableCreateTime:null,colOrder:[],colVisib:[],showAllColText:"",visibleHeadersCount:0,reorderHint:"",sortHint:"",markHint:"",copyHint:"",showReorderHint:false,showSortHint:false,showMarkHint:false,isCellEditActive:false,isEditCellTextEditable:false,currentEditCell:null,cellEditHint:"",gotoLinkText:"",wasEditedCellNull:false,maxTruncatedLen:0,saveCellsAtOnce:false,isCellEdited:false,saveCellWarning:"",lastXHR:null,isSaving:false,alertNonUnique:"",token:null,server:null,db:null,table:null,dragStartRsz:function(j,g){var k=$(c.cRsz).find("div").index(g);$(g).addClass("colborder_active");c.colRsz={x0:j.pageX,n:k,obj:g,objLeft:$(g).position().left,objWidth:$(c.t).find("th.draggable:visible:eq("+k+") span").outerWidth()};$(document.body).css("cursor","col-resize").noSelect();if(c.isCellEditActive){c.hideEditCell()}},dragStartReorder:function(k,j){$(c.cCpy).text($(j).text());var g=$(j).position();$(c.cCpy).css({top:g.top+20,left:g.left,height:$(j).height(),width:$(j).width()});$(c.cPointer).css({top:g.top});var l=c.getHeaderIdx(j);c.colReorder={x0:k.pageX,y0:k.pageY,n:l,newn:l,obj:j,objTop:g.top,objLeft:g.left};$(document.body).css("cursor","move").noSelect();if(c.isCellEditActive){c.hideEditCell()}},dragMove:function(k){if(c.colRsz){var g=k.pageX-c.colRsz.x0;if(c.colRsz.objWidth+g>c.minColWidth){$(c.colRsz.obj).css("left",c.colRsz.objLeft+g+"px")}}else{if(c.colReorder){var g=k.pageX-c.colReorder.x0;$(c.cCpy).css("left",c.colReorder.objLeft+g).show();var j=c.getHoveredCol(k);if(j){var n=c.getHeaderIdx(j);c.colReorder.newn=n;if(n!=c.colReorder.n){var m=$(j).position();var l=n<c.colReorder.n?m.left:m.left+$(j).outerWidth();$(c.cPointer).css({left:l,visibility:"visible"})}else{$(c.cPointer).css("visibility","hidden")}}}}},dragEnd:function(l){if(c.colRsz){var k=l.pageX-c.colRsz.x0;var g=c.colRsz.objWidth+k;if(g<c.minColWidth){g=c.minColWidth}var m=c.colRsz.n;c.resize(m,g);c.reposRsz();c.reposDrop();c.colRsz=false;$(c.cRsz).find("div").removeClass("colborder_active")}else{if(c.colReorder){if(c.colReorder.newn!=c.colReorder.n){c.shiftCol(c.colReorder.n,c.colReorder.newn);var j=$(c.colReorder.obj).position();c.colReorder.objTop=j.top;c.colReorder.objLeft=j.left;c.colReorder.n=c.colReorder.newn;if(c.tableCreateTime){c.sendColPrefs()}c.refreshRestoreButton()}$(c.cCpy).stop(true,true).animate({top:c.colReorder.objTop,left:c.colReorder.objLeft},"fast").fadeOut();$(c.cPointer).css("visibility","hidden");c.colReorder=false}}$(document.body).css("cursor","inherit").noSelect(false)},resize:function(j,g){$(c.t).find("tr").each(function(){$(this).find("th.draggable:visible:eq("+j+") span,td:visible:eq("+(c.actionSpan+j)+") span").css("width",g)})},reposRsz:function(){$(c.cRsz).find("div").hide();var m=$(c.t).find("tr:first th.draggable:visible");var k=$(c.cRsz).find("div").removeClass("condition");$("table.pma_table").find("thead th:first").removeClass("before-condition");for(var o=0,g=m.length;o<g;o++){var j=$(m[o]);$(k[o]).css("left",j.position().left+j.outerWidth(true)).show();if(j.hasClass("condition")){$(k[o]).addClass("condition");if(o>0){$(k[o-1]).addClass("condition")}}}if($(k[0]).hasClass("condition")){$("table.pma_table").find("thead th:first").addClass("before-condition")}$(c.cRsz).css("height",$(c.t).height())},shiftCol:function(j,k){$(c.t).find("tr").each(function(){if(k<j){$(this).find("th.draggable:eq("+k+"),td:eq("+(c.actionSpan+k)+")").before($(this).find("th.draggable:eq("+j+"),td:eq("+(c.actionSpan+j)+")"))}else{$(this).find("th.draggable:eq("+k+"),td:eq("+(c.actionSpan+k)+")").after($(this).find("th.draggable:eq("+j+"),td:eq("+(c.actionSpan+j)+")"))}});c.reposRsz();if(k<j){$(c.cList).find(".lDiv div:eq("+k+")").before($(c.cList).find(".lDiv div:eq("+j+")"))}else{$(c.cList).find(".lDiv div:eq("+k+")").after($(c.cList).find(".lDiv div:eq("+j+")"))}var g=c.colOrder[j];c.colOrder.splice(j,1);c.colOrder.splice(k,0,g);if(c.colVisib.length>0){g=c.colVisib[j];c.colVisib.splice(j,1);c.colVisib.splice(k,0,g)}},getHoveredCol:function(j){var g;$headers=$(c.t).find("th.draggable:visible");$headers.each(function(){var l=$(this).offset().left;var k=l+$(this).outerWidth();if(l<=j.pageX&&j.pageX<=k){g=this}});return g},getHeaderIdx:function(g){return $(g).parents("tr").find("th.draggable").index(g)},restoreColOrder:function(){for(var l=1;l<c.colOrder.length;l++){var g=c.colOrder[l];var k=l-1;while(k>=0&&g<c.colOrder[k]){k--}if(k!=l-1){c.shiftCol(l,k+1)}}if(c.tableCreateTime){c.sendColPrefs()}c.refreshRestoreButton()},sendColPrefs:function(){if($(c.t).is(".ajax")){var g={ajax_request:true,db:c.db,table:c.table,token:c.token,server:c.server,set_col_prefs:true,table_create_time:c.tableCreateTime};if(c.colOrder.length>0){$.extend(g,{col_order:c.colOrder.toString()})}if(c.colVisib.length>0){$.extend(g,{col_visib:c.colVisib.toString()})}$.post("sql.php",g,function(k){if(k.success!=true){var j=$(document.createElement("div"));j.html(k.error);j.addClass("error");PMA_ajaxShowMessage(j,false)}})}},refreshRestoreButton:function(){var j=true;for(var g=0;g<c.colOrder.length;g++){if(c.colOrder[g]!=g){j=false;break}}var k=c.visibleHeadersCount==1;if(j||k){$("div.restore_column").hide()}else{$("div.restore_column").show()}},updateHint:function(){var g="";if(!c.colRsz&&!c.colReorder){if(c.visibleHeadersCount>1){c.showReorderHint=true}if($(b).find("th.marker").length>0){c.showMarkHint=true}if(c.showReorderHint&&c.reorderHint){g+=c.reorderHint}if(c.showSortHint&&c.sortHint){g+=g.length>0?"<br />":"";g+=c.sortHint}if(c.showMarkHint&&c.markHint&&!c.showSortHint){g+=g.length>0?"<br />":"";g+=c.markHint;g+=g.length>0?"<br />":"";g+=c.copyHint}}return g},toggleCol:function(g){if(c.colVisib[g]){if(c.visibleHeadersCount>1){$(c.t).find("tr").each(function(){$(this).find("th.draggable:eq("+g+"),td:eq("+(c.actionSpan+g)+")").hide()});c.colVisib[g]=0;$(c.cList).find(".lDiv div:eq("+g+") input").prop("checked",false)}else{$(c.cList).find(".lDiv div:eq("+g+") input").prop("checked",true);return false}}else{$(c.t).find("tr").each(function(){$(this).find("th.draggable:eq("+g+"),td:eq("+(c.actionSpan+g)+")").show()});c.colVisib[g]=1;$(c.cList).find(".lDiv div:eq("+g+") input").prop("checked",true)}return true},afterToggleCol:function(){c.reposRsz();c.reposDrop();c.sendColPrefs();c.visibleHeadersCount=$(c.t).find("tr:first th.draggable:visible").length;c.refreshRestoreButton()},showColList:function(g){if(!c.colRsz&&!c.colReorder){var j=$(g).position();if(j.left+$(c.cList).outerWidth(true)>$(document).width()){j.left=$(document).width()-$(c.cList).outerWidth(true)}$(c.cList).css({left:j.left,top:j.top+$(g).outerHeight(true)}).show();$(g).addClass("coldrop-hover")}},hideColList:function(){$(c.cList).hide();$(c.cDrop).find(".coldrop-hover").removeClass("coldrop-hover")},reposDrop:function(){var j=$(b).find("th:not(.draggable)");for(var g=0;g<j.length;g++){var k=$(c.cDrop).find("div:eq("+g+")");var l=$(j[g]).position();k.css({left:l.left+$(j[g]).width()-k.width(),top:l.top})}},showAllColumns:function(){for(var g=0;g<c.colVisib.length;g++){if(!c.colVisib[g]){c.toggleCol(g)}}c.afterToggleCol()},showEditCell:function(g){if($(g).is(".grid_edit")&&!c.colRsz&&!c.colReorder){if(!c.isCellEditActive){var k=$(g);$(c.cEdit).find(".edit_area").empty().hide();$(c.cEdit).css({top:k.position().top,left:k.position().left}).show().find(".edit_box").css({width:k.outerWidth(),height:k.outerHeight()});var j=PMA_getCellValue(g);$(c.cEdit).find(".edit_box").val(j);c.currentEditCell=g;$(c.cEdit).find(".edit_box").focus();$(c.cEdit).find("*").removeProp("disabled")}}},hideEditCell:function(l,k,n){if(c.isCellEditActive&&!l){c.saveOrPostEditedCell();return}if(c.lastXHR!=null){c.lastXHR.abort();c.lastXHR=null}if(k){if(c.currentEditCell){var g=$(c.currentEditCell);var j=g.data("value")==null;if(j){g.find("span").html("NULL");g.addClass("null")}else{g.removeClass("null");var m=k.isNeedToRecheck?k.truncatableFieldValue:g.data("value");if(g.is(".truncated")){if(m.length>c.maxTruncatedLen){m=m.substring(0,c.maxTruncatedLen)+"..."}}g.find("span").text(m)}}if(k.transformations!=undefined){$.each(k.transformations,function(r,q){var p=$(c.t).find(".to_be_saved:eq("+r+")");p.find("span").html(q)})}if(k.relations!=undefined){$.each(k.relations,function(r,q){var p=$(c.t).find(".to_be_saved:eq("+r+")");p.find("span").html(q)})}c.reposRsz();c.reposDrop()}$(c.cEdit).hide();$(c.cEdit).find(".edit_box").blur();c.isCellEditActive=false;c.currentEditCell=null;var o=$(c.cEdit).find(".hasDatepicker");if(o.length>0){o.datepicker("destroy");$(c.cEdit).find(".edit_box").css("cursor","inherit")}},showEditArea:function(){if(!c.isCellEditActive){c.isCellEditActive=true;c.isEditCellTextEditable=false;var j=$(c.currentEditCell);var m=$(c.cEdit).find(".edit_area");var g=j.parent("tr").find(".where_clause").val();var o=getFieldName(j);var s=j.text();var v=j.find("a").attr("title");var r=j.find("span").text();m.empty();if(j.find("input").hasClass("data_browse_link")){var q=document.createElement("div");q.className="goto_link";$(q).append("<a href='"+j.find(".data_browse_link").val()+"'>"+c.showDataRowLinkText+"</a>");m.append(q)}if(j.find("a").length>0){var w=document.createElement("div");w.className="goto_link";$(w).append(c.gotoLinkText+": ").append(j.find("a").clone().click(function(z){z.preventDefault();window.open(this.href)}));m.append(w)}c.wasEditedCellNull=false;if(j.is(":not(.not_null)")){m.append('<div class="null_div">Null :<input type="checkbox"></div>');var l=m.find(".null_div input");if(j.is(".null")){l.prop("checked",true);c.wasEditedCellNull=true}if(j.is(".enum, .set")){m.find("select").live("change",function(z){l.prop("checked",false)})}else{if(j.is(".relation")){m.find("select").live("change",function(z){l.prop("checked",false)});m.find(".browse_foreign").live("click",function(z){l.prop("checked",false)})}else{$(c.cEdit).find(".edit_box").live("keypress change",function(z){l.prop("checked",false)});$(c.cEdit).find(".edit_box").live("keydown",function(z){if(z.ctrlKey&&z.which==86){l.prop("checked",false)}});m.find("textarea").live("keydown",function(z){l.prop("checked",false)})}}l.click(function(z){if(j.is(".enum")){m.find("select").val("")}else{if(j.is(".set")){m.find("select").find("option").each(function(){var A=$(this);A.prop("selected",false)})}else{if(j.is(".relation")){if(m.find("select").length>0){m.find("select").val("")}}else{m.find("textarea").val("")}}}$(c.cEdit).find(".edit_box").val("")})}if(j.is(".relation")){m.addClass("edit_area_loading");j.data("original_data",null);var k={ajax_request:true,get_relational_values:true,server:c.server,db:c.db,table:c.table,column:o,token:c.token,curr_value:s,relation_key_or_display_column:v};c.lastXHR=$.post("sql.php",k,function(A){c.lastXHR=null;m.removeClass("edit_area_loading");if($(A.dropdown).is("select")){var z=$(A.dropdown).val();j.data("original_data",z);$(c.cEdit).find(".edit_box").val(z)}m.append(A.dropdown);m.append('<div class="cell_edit_hint">'+c.cellEditHint+"</div>");m.find("span.curr_value").hide();m.find("span.curr_value").change(function(){$(c.cEdit).find(".edit_box").val($(this).text())})});m.show();m.find("select").live("change",function(z){$(c.cEdit).find(".edit_box").val($(this).val())});c.isEditCellTextEditable=true}else{if(j.is(".enum")){m.addClass("edit_area_loading");var k={ajax_request:true,get_enum_values:true,server:c.server,db:c.db,table:c.table,column:o,token:c.token,curr_value:r};c.lastXHR=$.post("sql.php",k,function(z){c.lastXHR=null;m.removeClass("edit_area_loading");m.append(z.dropdown);m.append('<div class="cell_edit_hint">'+c.cellEditHint+"</div>")});m.show();m.find("select").live("change",function(z){$(c.cEdit).find(".edit_box").val($(this).val())})}else{if(j.is(".set")){m.addClass("edit_area_loading");var k={ajax_request:true,get_set_values:true,server:c.server,db:c.db,table:c.table,column:o,token:c.token,curr_value:r};c.lastXHR=$.post("sql.php",k,function(z){c.lastXHR=null;m.removeClass("edit_area_loading");m.append(z.select);m.append('<div class="cell_edit_hint">'+c.cellEditHint+"</div>")});m.show();m.find("select").live("change",function(z){$(c.cEdit).find(".edit_box").val($(this).val())})}else{if(j.is(".truncated, .transformed")){if(j.is(".to_be_saved")){var u=j.data("value");$(c.cEdit).find(".edit_box").val(u);m.append("<textarea></textarea>");m.find("textarea").val(u).live("keyup",function(z){$(c.cEdit).find(".edit_box").val($(this).val())});$(c.cEdit).find(".edit_box").live("keyup",function(z){m.find("textarea").val($(this).val())});m.append('<div class="cell_edit_hint">'+c.cellEditHint+"</div>")}else{m.addClass("edit_area_loading");j.data("original_data",null);var t="SELECT `"+o+"` FROM `"+c.table+"` WHERE "+PMA_urldecode(g);c.lastXHR=$.post("sql.php",{token:c.token,server:c.server,db:c.db,ajax_request:true,sql_query:t,grid_edit:true},function(z){c.lastXHR=null;m.removeClass("edit_area_loading");if(z.success==true){if(j.is(".truncated")){c.maxTruncatedLen=$(c.currentEditCell).text().length-3}j.data("original_data",z.value);$(c.cEdit).find(".edit_box").val(z.value);m.append("<textarea></textarea>");m.find("textarea").val(z.value).live("keyup",function(A){$(c.cEdit).find(".edit_box").val($(this).val())});$(c.cEdit).find(".edit_box").live("keyup",function(A){m.find("textarea").val($(this).val())});m.append('<div class="cell_edit_hint">'+c.cellEditHint+"</div>")}else{PMA_ajaxShowMessage(z.error,false)}});m.show()}c.isEditCellTextEditable=true}else{if(j.is(".datefield, .datetimefield, .timestampfield")){var x=$(c.cEdit).find(".edit_box");var n=j.is(".null");var p=!n?x.val():"";var y=true;if(j.is(".datefield")){y=false}PMA_addDatepicker(m,{altField:x,showTimepicker:y,onSelect:function(A,z){$(c.cEdit).find(".null_div input[type=checkbox]").prop("checked",false)}});m.find("> *").click(function(z){z.stopPropagation()});if(n||p=="0000-00-00"||p=="0000-00-00 00:00:00"){x.val(p)}else{m.datetimepicker("setDate",p)}m.append('<div class="cell_edit_hint">'+c.cellEditHint+"</div>");x.css("cursor","");c.isEditCellTextEditable=true}else{c.isEditCellTextEditable=true;if(m.children().length>0){m.append('<div class="cell_edit_hint">'+c.cellEditHint+"</div>")}}}}}}if(m.children().length>0){m.show()}}},postEditedCell:function(){if(c.isSaving){return}c.isSaving=true;var j={};var l=$("#relational_display_K").prop("checked")?"K":"D";var r={};var p=false;var o="";var u="";var m="";var s=[];var n=$("td.edit_row_anchor").is(".nonunique")?0:1;var k=[];var t=[];var q=[];if(!n){alert(c.alertNonUnique)}$("td.to_be_saved").parents("tr").each(function(){var B=$(this);var y=B.find(".where_clause").val();s.push(PMA_urldecode(y));var A=jQuery.parseJSON(B.find(".condition_array").val());var z=[];var w=[];var x=[];B.find(".to_be_saved").each(function(){var E=$(this);var F=getFieldName(E);var D={};if(E.is(".transformed")){p=true}D[F]=E.data("value");var G=D[F]===null;z.push(F);if(G){x.push("on");w.push("")}else{x.push("");w.push(E.data("value"));var J=E.index(".to_be_saved");if(E.is(":not(.relation, .enum, .set, .bit)")){if(E.is(".transformed")){r[J]={};$.extend(r[J],D)}}else{if(E.is(".relation")){j[J]={};$.extend(j[J],D)}}}if(y.indexOf(PMA_urlencode(F))>-1){var I="`"+c.table+"`.`"+F+"`";for(var H in A){if(H.indexOf(I)>-1){A[H]=G?"IS NULL":"= '"+D[F].replace(/'/g,"''")+"'";break}}}});var v="";for(var C in A){v+=C+" "+A[C]+" AND "}v=v.substring(0,v.length-5);v=PMA_urlencode(v);B.data("new_clause",v);B.find(".condition_array").val(JSON.stringify(A));k.push(z);t.push(w);q.push(x)});u=$.param(j);m=$.param(r);var g={ajax_request:true,sql_query:o,token:c.token,server:c.server,db:c.db,table:c.table,clause_is_unique:n,where_clause:s,"fields[multi_edit]":t,"fields_name[multi_edit]":k,"fields_null[multi_edit]":q,rel_fields_list:u,do_transformations:p,transform_fields_list:m,relational_display:l,"goto":"sql.php",submit_type:"save"};if(!c.saveCellsAtOnce){$(c.cEdit).find("*").prop("disabled",true);$(c.cEdit).find(".edit_box").addClass("edit_box_posting")}else{$("div.save_edited").addClass("saving_edited_data").find("input").prop("disabled",true)}$.ajax({type:"POST",url:"tbl_replace.php",data:g,success:function(v){c.isSaving=false;if(!c.saveCellsAtOnce){$(c.cEdit).find("*").removeProp("disabled");$(c.cEdit).find(".edit_box").removeClass("edit_box_posting")}else{$("div.save_edited").removeClass("saving_edited_data").find("input").removeProp("disabled")}if(v.success==true){PMA_ajaxShowMessage(v.message);$("td.to_be_saved").parents("tr").each(function(){var w=$(this).data("new_clause");var y=$(this).find(".where_clause");var z=y.val();var x=PMA_urldecode(z);var A=PMA_urldecode(w);y.val(w);$(this).find("a").each(function(){$(this).attr("href",$(this).attr("href").replace(z,w));if($(this).attr("href").indexOf("DELETE")>-1){$(this).removeAttr("onclick").unbind("click").bind("click",function(){return confirmLink(this,"DELETE FROM `"+c.db+"`.`"+c.table+"` WHERE "+A+(n?"":" LIMIT 1"))})}});$(this).find("input[type=checkbox]").each(function(){var D=$(this);var C=D.attr("name");var B=D.val();D.attr("name",C.replace(z,w));D.val(B.replace(x,A))})});$("#result_query").remove();if(typeof v.sql_query!="undefined"){$("#sqlqueryresults").prepend(v.sql_query)}c.hideEditCell(true,v);$("div.save_edited").hide();$(c.t).find(".to_be_saved").removeClass("to_be_saved").data("value",null).data("original_data",null);c.isCellEdited=false}else{PMA_ajaxShowMessage(v.error,false)}}})},saveEditedCell:function(){var j=$(c.currentEditCell);var k="";var o=false;var l=getFieldName(j);var g={};var n=$(c.cEdit).find("input:checkbox").is(":checked");var m;if($(c.cEdit).find(".edit_area").is(".edit_area_loading")){o=false}else{if(n){if(!c.wasEditedCellNull){g[l]=null;o=true}}else{if(j.is(".bit")){g[l]="0b"+$(c.cEdit).find(".edit_box").val()}else{if(j.is(".set")){k=$(c.cEdit).find("select");g[l]=k.map(function(){return $(this).val()}).get().join(",")}else{if(j.is(".relation, .enum")){g[l]=$(c.cEdit).find(".edit_box").val()}else{g[l]=$(c.cEdit).find(".edit_box").val()}}}if(c.wasEditedCellNull||g[l]!=PMA_getCellValue(c.currentEditCell)){o=true}}}if(o){$(c.currentEditCell).addClass("to_be_saved").data("value",g[l]);if(c.saveCellsAtOnce){$("div.save_edited").show()}c.isCellEdited=true}return o},saveOrPostEditedCell:function(){var g=c.saveEditedCell();if(!c.saveCellsAtOnce){if(g){c.postEditedCell()}else{c.hideEditCell(true)}}else{if(g){c.hideEditCell(true,true)}else{c.hideEditCell(true)}}},initColResize:function(){c.cRsz=document.createElement("div");c.cRsz.className="cRsz";var g=$(c.t).find("tr:first th.draggable");g.each(function(){var j=document.createElement("div");$(j).addClass("colborder").mousedown(function(k){c.dragStartRsz(k,this)});$(c.cRsz).append(j)});c.reposRsz();$(c.gDiv).prepend(c.cRsz)},initColReorder:function(){c.cCpy=document.createElement("div");c.cPointer=document.createElement("div");c.cCpy.className="cCpy";$(c.cCpy).hide();c.cPointer.className="cPointer";$(c.cPointer).css("visibility","hidden");c.reorderHint=PMA_messages.strColOrderHint;var j=$(c.t).find("tr:first th.draggable");$col_order=$("#col_order");if($col_order.length>0){c.colOrder=$col_order.val().split(",");for(var g=0;g<c.colOrder.length;g++){c.colOrder[g]=parseInt(c.colOrder[g])}}else{c.colOrder=[];for(var g=0;g<j.length;g++){c.colOrder.push(g)}}$(b).find("th.draggable").mousedown(function(k){if(c.visibleHeadersCount>1){c.dragStartReorder(k,this)}}).mouseenter(function(k){if(c.visibleHeadersCount>1){$(this).css("cursor","move")}else{$(this).css("cursor","inherit")}}).mouseleave(function(k){c.showReorderHint=false;$(this).tooltip("option",{content:c.updateHint()})}).dblclick(function(k){k.preventDefault();$("<div/>").prop("title",PMA_messages.strColNameCopyTitle).addClass("modal-copy").text(PMA_messages.strColNameCopyText).append($("<input/>").prop("readonly",true).val($(this).data("column"))).dialog({resizable:false,modal:true}).find("input").focus().select()});$("div.restore_column").click(function(){c.restoreColOrder()});$(c.gDiv).append(c.cPointer);$(c.gDiv).append(c.cCpy);$(b).find("th a").bind("dragstart",function(){return false});c.refreshRestoreButton()},initColVisib:function(){c.cDrop=document.createElement("div");c.cList=document.createElement("div");c.cDrop.className="cDrop";c.cList.className="cList";$(c.cList).hide();c.showAllColText=PMA_messages.strShowAllCol;var p=$(c.t).find("tr:first th.draggable");var q=$("#col_visib");if(q.length>0){c.colVisib=q.val().split(",");for(var n=0;n<c.colVisib.length;n++){c.colVisib[n]=parseInt(c.colVisib[n])}}else{c.colVisib=[];for(var n=0;n<p.length;n++){c.colVisib.push(1)}}if(p.length>1){var g=$(c.t).find("th:not(.draggable)");PMA_tooltip(g,"th",PMA_messages.strColVisibHint);g.each(function(){var r=$(this);var s=document.createElement("div");var t=r.position();$(s).addClass("coldrop").click(function(){if(c.cList.style.display=="none"){c.showColList(this)}else{c.hideColList()}});$(c.cDrop).append(s)});c.cList.innerHTML='<div class="lDiv"></div>';var j=$(c.cList).find("div");for(var n=0;n<p.length;n++){var m=p[n];var k=document.createElement("div");$(k).text($(m).text()).prepend('<input type="checkbox" '+(c.colVisib[n]?'checked="checked" ':"")+"/>");j.append(k);$(k).click(function(){if(c.toggleCol($(this).index())){c.afterToggleCol()}})}var l=document.createElement("div");$(l).addClass("showAllColBtn").text(c.showAllColText);$(c.cList).append(l);$(l).click(function(){c.showAllColumns()});if(p.length>10){var o=l.cloneNode(true);$(c.cList).prepend(o);$(o).click(function(){c.showAllColumns()})}}$(b).find("td, th.draggable").mouseenter(function(){c.hideColList()});$(c.gDiv).append(c.cDrop);$(c.gDiv).append(c.cList);c.reposDrop()},initGridEdit:function(){function g(k,j){if(c.isCellEditActive){c.saveOrPostEditedCell()}else{c.showEditCell(j)}k.stopPropagation()}c.cEdit=document.createElement("div");c.cEdit.className="cEdit";$(c.cEdit).html('<textarea class="edit_box" rows="1" ></textarea><div class="edit_area" />');$(c.cEdit).hide();c.cellEditHint=PMA_messages.strCellEditHint;c.saveCellWarning=PMA_messages.strSaveCellWarning;c.alertNonUnique=PMA_messages.strAlertNonUnique;c.gotoLinkText=PMA_messages.strGoToLink;c.showDataRowLinkText=PMA_messages.strShowDataRowLink;c.saveCellsAtOnce=$("#save_cells_at_once").val();$(b).find("td.data.click1").click(function(j){g(j,this);if($(j.target).is(".grid_edit a")){j.preventDefault()}});$(b).find("td.data.click2").click(function(l){$cell=$(this);var j=$(l.target);if(j.is(".grid_edit.relation a")){l.preventDefault();var k=$cell.data("clicks");k=(k==null)?1:k+1;if(k==1){timer=setTimeout(function(){j.removeClass("ajax");AJAX.requestHandler.call(j[0]);j.addClass("ajax");$cell.data("clicks",0)},700);$cell.data("clicks",k);$cell.data("timer",timer)}else{clearTimeout($cell.data("timer"));$cell.data("clicks",0);g(l,this)}}}).dblclick(function(j){if($(j.target).is(".grid_edit a")){j.preventDefault()}else{g(j,this)}});$(c.cEdit).find(".edit_box").focus(function(j){c.showEditArea()});$(c.cEdit).find(".edit_box, select").live("keydown",function(j){if(j.which==13){j.preventDefault();c.saveOrPostEditedCell()}});$(c.cEdit).keydown(function(j){if(!c.isEditCellTextEditable){j.preventDefault()}});$("html").click(function(j){if($(j.target).parents().index(c.cEdit)==-1){c.hideEditCell()}}).keydown(function(j){if(j.which==27&&c.isCellEditActive){c.hideEditCell(true)}});$("div.save_edited").click(function(){c.hideEditCell();c.postEditedCell()});$(window).bind("beforeunload",function(j){if(c.isCellEdited){return c.saveCellWarning}});$(c.gDiv).append(c.cEdit);if(PMA_messages.strGridEditFeatureHint!=undefined){PMA_tooltip($(c.t).find(".edit_row_anchor a"),"a",PMA_messages.strGridEditFeatureHint)}}};$(b).find("th, td:not(:has(span))").wrapInner("<span />");c.gDiv=document.createElement("div");c.t=b;var i=$(b).find("tr:first th.draggable");c.visibleHeadersCount=i.filter(":visible").length;if(!$(b).find("tr:first th:first").hasClass("draggable")){c.actionSpan=$(b).find("tr:first th:first").prop("colspan")}else{c.actionSpan=0}c.tableCreateTime=$("#table_create_time").val();c.sortHint=PMA_messages.strSortHint;c.markHint=PMA_messages.strColMarkHint;c.copyHint=PMA_messages.strColNameCopyHint;var h=$("div.common_hidden_inputs");c.token=h.find("input[name=token]").val();c.server=h.find("input[name=server]").val();c.db=h.find("input[name=db]").val();c.table=h.find("input[name=table]").val();$(b).addClass("pma_table");$(c.gDiv).css("position","relative");$(b).before(c.gDiv);$(c.gDiv).append(b);f=f==undefined?true:f;d=d==undefined?true:d;e=e==undefined?true:e;a=a==undefined?true:a;if(f){c.initColResize()}if(d&&$("table.navigation").length>0){c.initColReorder()}if(e){c.initColVisib()}if(a&&$(b).is(".ajax")){c.initGridEdit()}PMA_tooltip($(b).find("th.draggable"),"th",c.updateHint());$(b).find("th.draggable a").mouseenter(function(g){c.showSortHint=true;$(b).find("th.draggable").tooltip("option",{content:c.updateHint()})}).mouseleave(function(g){c.showSortHint=false;$(b).find("th.draggable").tooltip("option",{content:c.updateHint()})});if(f||d){$(document).mousemove(function(g){c.dragMove(g)});$(document).mouseup(function(g){c.dragEnd(g)})}$(b).removeClass("data");$(c.gDiv).addClass("data")};