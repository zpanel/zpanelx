function rcmail_zipmessages(){rcmail.message_list&&1<rcmail.message_list.get_selection().length&&rcmail.goto_url("plugin.zipdownload.zip_messages","_mbox="+urlencode(rcmail.env.mailbox)+"&_uid="+rcmail.message_list.get_selection().join(","))}
$(document).ready(function(){window.rcmail&&(rcmail.addEventListener("init",function(a){rcmail.register_command("plugin.zipdownload.zip_folder",function(){rcmail.goto_url("plugin.zipdownload.zip_folder","_mbox="+urlencode(rcmail.env.mailbox))},0<rcmail.env.messagecount);rcmail.message_list&&rcmail.env.zipdownload_selection&&(rcmail.message_list.addEventListener("select",function(a){rcmail.enable_command("download",0<a.get_selection().length)}),rcmail.contextmenu_disable_multi&&rcmail.contextmenu_disable_multi.splice($.inArray("#download",
rcmail.contextmenu_disable_multi),1))}),rcmail.addEventListener("listupdate",function(a){rcmail.enable_command("plugin.zipdownload.zip_folder",0<rcmail.env.messagecount)}),rcmail.addEventListener("beforedownload",function(a){rcmail_zipmessages()}))});
